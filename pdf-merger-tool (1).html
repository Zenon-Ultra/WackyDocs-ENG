<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì–‘ë©´ PDF ë³‘í•© ë„êµ¬</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
            text-align: center;
        }

        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .upload-section {
            margin-bottom: 25px;
        }

        .upload-section label {
            display: block;
            font-weight: 600;
            color: #555;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: block;
            padding: 15px;
            background: #f8f9fa;
            border: 2px dashed #667eea;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            color: #667eea;
            font-weight: 500;
        }

        .file-input-label:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .file-name {
            margin-top: 10px;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 5px;
            font-size: 14px;
            color: #2e7d32;
            display: none;
        }

        .file-name.show {
            display: block;
        }

        .merge-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 20px;
        }

        .merge-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .merge-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: 500;
            display: none;
        }

        .status.show {
            display: block;
        }

        .status.success {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status.error {
            background: #ffebee;
            color: #c62828;
        }

        .status.processing {
            background: #fff3e0;
            color: #ef6c00;
        }

        .instructions {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            font-size: 14px;
            color: #555;
            line-height: 1.8;
        }

        .instructions h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“„ ì–‘ë©´ PDF ë³‘í•© ë„êµ¬</h1>
        <p class="subtitle">í™€ìˆ˜/ì§ìˆ˜ í˜ì´ì§€ë¥¼ í•˜ë‚˜ì˜ PDFë¡œ ë³‘í•©í•©ë‹ˆë‹¤</p>

        <div class="upload-section">
            <label>í™€ìˆ˜ í˜ì´ì§€ PDF (1, 3, 5, 7...)</label>
            <div class="file-input-wrapper">
                <input type="file" id="oddFile" accept=".pdf">
                <label for="oddFile" class="file-input-label">
                    ğŸ“‚ íŒŒì¼ ì„ íƒí•˜ê¸°
                </label>
            </div>
            <div id="oddFileName" class="file-name"></div>
        </div>

        <div class="upload-section">
            <label>ì§ìˆ˜ í˜ì´ì§€ PDF (2, 4, 6, 8...)</label>
            <div class="file-input-wrapper">
                <input type="file" id="evenFile" accept=".pdf">
                <label for="evenFile" class="file-input-label">
                    ğŸ“‚ íŒŒì¼ ì„ íƒí•˜ê¸°
                </label>
            </div>
            <div id="evenFileName" class="file-name"></div>
        </div>

        <button id="mergeBtn" class="merge-btn" disabled>
            ğŸ”„ PDF ë³‘í•©í•˜ê¸°
        </button>

        <div id="status" class="status"></div>

        <div class="instructions">
            <h3>ğŸ“ ì‚¬ìš© ë°©ë²•</h3>
            <ol>
                <li>í™€ìˆ˜ í˜ì´ì§€ê°€ ìˆëŠ” PDF íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</li>
                <li>ì§ìˆ˜ í˜ì´ì§€ê°€ ìˆëŠ” PDF íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</li>
                <li>"PDF ë³‘í•©í•˜ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</li>
                <li>ë³‘í•©ëœ PDFê°€ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤</li>
            </ol>
        </div>
    </div>

    <script>
        const { PDFDocument } = PDFLib;

        const oddFileInput = document.getElementById('oddFile');
        const evenFileInput = document.getElementById('evenFile');
        const oddFileName = document.getElementById('oddFileName');
        const evenFileName = document.getElementById('evenFileName');
        const mergeBtn = document.getElementById('mergeBtn');
        const status = document.getElementById('status');

        let oddFile = null;
        let evenFile = null;

        oddFileInput.addEventListener('change', (e) => {
            oddFile = e.target.files[0];
            if (oddFile) {
                oddFileName.textContent = `âœ“ ${oddFile.name}`;
                oddFileName.classList.add('show');
                checkFiles();
            }
        });

        evenFileInput.addEventListener('change', (e) => {
            evenFile = e.target.files[0];
            if (evenFile) {
                evenFileName.textContent = `âœ“ ${evenFile.name}`;
                evenFileName.classList.add('show');
                checkFiles();
            }
        });

        function checkFiles() {
            if (oddFile && evenFile) {
                mergeBtn.disabled = false;
            }
        }

        function showStatus(message, type) {
            status.textContent = message;
            status.className = 'status show ' + type;
        }

        async function mergePDFs() {
            try {
                showStatus('PDF ì²˜ë¦¬ ì¤‘...', 'processing');
                mergeBtn.disabled = true;

                const oddBytes = await oddFile.arrayBuffer();
                const evenBytes = await evenFile.arrayBuffer();

                const oddPdf = await PDFDocument.load(oddBytes);
                const evenPdf = await PDFDocument.load(evenBytes);

                const mergedPdf = await PDFDocument.create();

                const oddPageCount = oddPdf.getPageCount();
                const evenPageCount = evenPdf.getPageCount();
                const maxPages = Math.max(oddPageCount, evenPageCount);

                for (let i = 0; i < maxPages; i++) {
                    if (i < oddPageCount) {
                        const [oddPage] = await mergedPdf.copyPages(oddPdf, [i]);
                        mergedPdf.addPage(oddPage);
                    }
                    
                    // ì§ìˆ˜ í˜ì´ì§€ëŠ” ì—­ìˆœìœ¼ë¡œ
                    const evenIndex = evenPageCount - 1 - i;
                    if (evenIndex >= 0) {
                        const [evenPage] = await mergedPdf.copyPages(evenPdf, [evenIndex]);
                        mergedPdf.addPage(evenPage);
                    }
                }

                const mergedPdfBytes = await mergedPdf.save();
                
                const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'ë³‘í•©ëœ_PDF.pdf';
                a.click();
                URL.revokeObjectURL(url);

                showStatus('âœ“ PDF ë³‘í•© ì™„ë£Œ! íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                mergeBtn.disabled = false;

            } catch (error) {
                showStatus('âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                mergeBtn.disabled = false;
                console.error(error);
            }
        }

        mergeBtn.addEventListener('click', mergePDFs);
    </script>
</body>
</html>